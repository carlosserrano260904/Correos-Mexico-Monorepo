<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Endpoints - Gu√≠as de Trazabilidad</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .commands-section {
            flex: 1;
            min-width: 400px;
        }
        .queries-section {
            flex: 1;
            min-width: 400px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 60px;
            resize: vertical;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .response {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .data-section {
            margin-top: 20px;
        }
        .data-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .fieldset {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .fieldset legend {
            font-weight: bold;
            padding: 0 10px;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .status-active {
            background-color: #28a745;
        }
        .status-inactive {
            background-color: #dc3545;
        }
        h1, h2, h3 {
            color: #333;
        }
        .search-form {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Prueba de Endpoints - Gu√≠as de Trazabilidad</h1>
    
    <div class="container">
        <!-- SECCI√ìN DE COMMANDS -->
        <div class="commands-section">
            <div class="section">
                <h2>Commands (POST)</h2>
                
                <!-- Formulario para crear nueva gu√≠a -->
                <div class="fieldset">
                    <legend>Crear Nueva Gu√≠a</legend>
                    <form id="crearGuiaForm">
                        <fieldset class="fieldset">
                            <legend>Remitente</legend>
                            <div class="form-group">
                                <label for="remitenteNombres">Nombres:</label>
                                <input type="text" id="remitenteNombres" name="remitenteNombres" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteApellidos">Apellidos:</label>
                                <input type="text" id="remitenteApellidos" name="remitenteApellidos" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteTelefono">Tel√©fono:</label>
                                <input type="text" id="remitenteTelefono" name="remitenteTelefono" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteCalle">Calle:</label>
                                <input type="text" id="remitenteCalle" name="remitenteCalle" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteNumero">N√∫mero:</label>
                                <input type="text" id="remitenteNumero" name="remitenteNumero" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteNumeroInterior">N√∫mero Interior:</label>
                                <input type="text" id="remitenteNumeroInterior" name="remitenteNumeroInterior">
                            </div>
                            <div class="form-group">
                                <label for="remitenteCiudad">Ciudad:</label>
                                <input type="text" id="remitenteCiudad" name="remitenteCiudad" required>
                            </div>
                            <div class="form-group">
                                <label for="remitentePais">Pa√≠s:</label>
                                <input type="text" id="remitentePais" name="remitentePais" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteCodigoPostal">C√≥digo Postal:</label>
                                <input type="text" id="remitenteCodigoPostal" name="remitenteCodigoPostal" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteEstado">Estado:</label>
                                <input type="text" id="remitenteEstado" name="remitenteEstado" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteMunicipio">Municipio/Delegaci√≥n:</label>
                                <input type="text" id="remitenteMunicipio" name="remitenteMunicipio" required>
                            </div>
                            <div class="form-group">
                                <label for="remitenteAsentamiento">Asentamiento:</label>
                                <input type="text" id="remitenteAsentamiento" name="remitenteAsentamiento">
                            </div>
                            <div class="form-group">
                                <label for="remitenteReferencia">Referencia:</label>
                                <input type="text" id="remitenteReferencia" name="remitenteReferencia">
                            </div>
                        </fieldset>
                        
                        <fieldset class="fieldset">
                            <legend>Destinatario</legend>
                            <div class="form-group">
                                <label for="destinatarioNombres">Nombres:</label>
                                <input type="text" id="destinatarioNombres" name="destinatarioNombres" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioApellidos">Apellidos:</label>
                                <input type="text" id="destinatarioApellidos" name="destinatarioApellidos" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioTelefono">Tel√©fono:</label>
                                <input type="text" id="destinatarioTelefono" name="destinatarioTelefono" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioCalle">Calle:</label>
                                <input type="text" id="destinatarioCalle" name="destinatarioCalle" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioNumero">N√∫mero:</label>
                                <input type="text" id="destinatarioNumero" name="destinatarioNumero" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioNumeroInterior">N√∫mero Interior:</label>
                                <input type="text" id="destinatarioNumeroInterior" name="destinatarioNumeroInterior">
                            </div>
                            <div class="form-group">
                                <label for="destinatarioCiudad">Ciudad:</label>
                                <input type="text" id="destinatarioCiudad" name="destinatarioCiudad" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioPais">Pa√≠s:</label>
                                <input type="text" id="destinatarioPais" name="destinatarioPais" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioCodigoPostal">C√≥digo Postal:</label>
                                <input type="text" id="destinatarioCodigoPostal" name="destinatarioCodigoPostal" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioEstado">Estado:</label>
                                <input type="text" id="destinatarioEstado" name="destinatarioEstado" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioMunicipio">Municipio/Delegaci√≥n:</label>
                                <input type="text" id="destinatarioMunicipio" name="destinatarioMunicipio" required>
                            </div>
                            <div class="form-group">
                                <label for="destinatarioAsentamiento">Asentamiento:</label>
                                <input type="text" id="destinatarioAsentamiento" name="destinatarioAsentamiento">
                            </div>
                            <div class="form-group">
                                <label for="destinatarioReferencia">Referencia:</label>
                                <input type="text" id="destinatarioReferencia" name="destinatarioReferencia">
                            </div>
                        </fieldset>
                        
                        <fieldset class="fieldset">
                            <legend>Dimensiones y Peso</legend>
                            <div class="form-group">
                                <label for="alto">Alto (cm):</label>
                                <input type="number" id="alto" name="alto" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="ancho">Ancho (cm):</label>
                                <input type="number" id="ancho" name="ancho" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="largo">Largo (cm):</label>
                                <input type="number" id="largo" name="largo" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="peso">Peso (kg):</label>
                                <input type="number" id="peso" name="peso" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="valorDeclarado">Valor Declarado ($):</label>
                                <input type="number" id="valorDeclarado" name="valorDeclarado" step="0.01" required>
                            </div>
                        </fieldset>
                        
                        <button type="submit">Crear Gu√≠a</button>
                    </form>
                    <div id="crearGuiaResponse" class="response"></div>
                </div>
                
                <!-- Formulario para registrar movimiento -->
                <div class="fieldset">
                    <legend>Registrar Movimiento</legend>
                    <form id="registrarMovimientoForm">
                        <div class="form-group">
                            <label for="numeroGuia">N√∫mero de Gu√≠a:</label>
                            <input type="text" id="numeroGuia" name="numeroGuia" required>
                        </div>
                        <div class="form-group">
                            <label for="idSucursal">ID Sucursal:</label>
                            <input type="text" id="idSucursal" name="idSucursal" required>
                        </div>
                        <div class="form-group">
                            <label for="idRuta">ID Ruta:</label>
                            <input type="text" id="idRuta" name="idRuta" required>
                        </div>
                        <div class="form-group">
                            <label for="estado">Estado:</label>
                            <select id="estado" name="estado" required>
                                <option value="">Seleccionar estado...</option>
                                <option value="Creado">Creado</option>
                                <option value="En proceso">En proceso</option>
                                <option value="En recoleccion">En recolecci√≥n</option>
                                <option value="Recolectado">Recolectado</option>
                                <option value="En transito">En tr√°nsito</option>
                                <option value="En aduana">En aduana</option>
                                <option value="En entrega">En entrega</option>
                                <option value="Entregado">Entregado</option>
                                <option value="Reprogramado">Reprogramado</option>
                                <option value="Cancelado">Cancelado</option>
                                <option value="Devuelto">Devuelto</option>
                                <option value="Rechazado">Rechazado</option>
                                <option value="Investigacion en curso">Investigaci√≥n en curso</option>
                                <option value="Perdida confirmada">P√©rdida confirmada</option>
                                <option value="Retrasado">Retrasado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="localizacion">Localizaci√≥n:</label>
                            <input type="text" id="localizacion" name="localizacion" required>
                        </div>
                        <button type="submit">Registrar Movimiento</button>
                    </form>
                    <div id="registrarMovimientoResponse" class="response"></div>
                </div>
                
                <!-- Formulario para crear incidencia -->
                <div class="fieldset">
                    <legend>Crear Incidencia</legend>
                    <form id="crearIncidenciaForm">
                        <div class="form-group">
                            <label for="numeroRastreo">N√∫mero de Rastreo:</label>
                            <input type="text" id="numeroRastreo" name="numeroRastreo" required>
                        </div>
                        <div class="form-group">
                            <label for="tipoIncidencia">Tipo de Incidencia:</label>
                            <select id="tipoIncidencia" name="tipoIncidencia" required>
                                <option value="">Seleccionar tipo...</option>
                                <option value="Extravio">Extrav√≠o</option>
                                <option value="Retraso">Retraso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="descripcion">Descripci√≥n:</label>
                            <textarea id="descripcion" name="descripcion" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="idResponsable">ID Responsable:</label>
                            <input type="text" id="idResponsable" name="idResponsable" required>
                        </div>
                        <button type="submit">Crear Incidencia</button>
                    </form>
                    <div id="crearIncidenciaResponse" class="response"></div>
                </div>
            </div>
        </div>
        
        <!-- SECCI√ìN DE QUERIES -->
        <div class="queries-section">
            <div class="section">
                <h2>Queries (GET) <span class="status-indicator status-active"></span></h2>
                
                <!-- Buscar gu√≠a por n√∫mero -->
                <div class="search-form">
                    <h3>Buscar Gu√≠a por N√∫mero</h3>
                    <div class="form-group">
                        <label for="buscarNumero">N√∫mero de Rastreo:</label>
                        <input type="text" id="buscarNumero" name="buscarNumero" placeholder="Ingrese n√∫mero de rastreo">
                        <button onclick="buscarGuia()">Buscar</button>
                    </div>
                    <div id="buscarGuiaResult" class="data-section"></div>
                </div>
                
                <!-- Todas las gu√≠as -->
                <div class="data-section">
                    <h3>Todas las Gu√≠as</h3>
                    <div id="todasGuias"></div>
                </div>
                
                <!-- Todas las incidencias -->
                <div class="data-section">
                    <h3>Todas las Incidencias</h3>
                    <div id="todasIncidencias"></div>
                </div>
                
                <!-- Todos los contactos -->
                <div class="data-section">
                    <h3>Todos los Contactos</h3>
                    <div id="todosContactos"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:3000/api/guias';
        
        // Funci√≥n para hacer peticiones HTTP
        async function makeRequest(url, method = 'GET', body = null) {
            const options = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                }
            };
            
            if (body) {
                options.body = JSON.stringify(body);
            }
            
            try {
                const response = await fetch(url, options);
                const data = await response.json();
                return { success: response.ok, data, status: response.status };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        // Funci√≥n para descargar PDF (para el endpoint nuevaGuia)
        async function downloadPDF(url, body, filename) {
            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(body)
            };
            
            try {
                const response = await fetch(url, options);
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`Error ${response.status}: ${errorData.message || 'Error desconocido'}`);
                }
                
                // Verificar si realmente es un PDF
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/pdf')) {
                    throw new Error('La respuesta no es un PDF v√°lido');
                }
                
                // Convertir a blob
                const blob = await response.blob();
                
                // Crear enlace de descarga
                const downloadUrl = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = downloadUrl;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(downloadUrl);
                
                return { success: true, message: 'PDF descargado exitosamente' };
                
            } catch (error) {
                return { success: false, error: error.message };
            }
        }
        
        // Funci√≥n para mostrar respuestas
        function showResponse(elementId, response) {
            const element = document.getElementById(elementId);
            if (response.success) {
                element.className = 'response success';
                element.textContent = JSON.stringify(response.data, null, 2);
            } else {
                element.className = 'response error';
                element.textContent = `Error: ${response.error || JSON.stringify(response.data, null, 2)}`;
            }
        }

        // Funci√≥n para mostrar notificaci√≥n de PDF generado
        function showPDFNotification(numeroRastreo) {
            // Crear notificaci√≥n visual
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #28a745, #20c997);
                color: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 1000;
                font-family: Arial, sans-serif;
                font-size: 16px;
                max-width: 400px;
                animation: slideIn 0.5s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 10px;">
                    <div style="width: 40px; height: 40px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                        <span style="color: #28a745; font-size: 20px; font-weight: bold;">‚úì</span>
                    </div>
                    <div>
                        <div style="font-weight: bold; font-size: 18px;">¬°Gu√≠a generada exitosamente!</div>
                        <div style="font-size: 14px; opacity: 0.9;">N√∫mero: ${numeroRastreo}</div>
                    </div>
                </div>
                <div style="font-size: 14px; margin-bottom: 15px;">
                     Haz recibido un pedido<br/>
                </div>
                <button onclick="this.parentElement.remove()" style="
                    background: rgba(255,255,255,0.2);
                    border: 1px solid rgba(255,255,255,0.3);
                    color: white;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 14px;
                ">Cerrar</button>
            `;
            
            // Agregar estilos de animaci√≥n
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Auto-cerrar despu√©s de 8 segundos
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 8000);
            
            // Tambi√©n mostrar alert tradicional
            alert(`Se genero el PDF\n\n N√∫mero de Rastreo: ${numeroRastreo}\n El archivo PDF se descargo\n Archivo enviado a la bandeja del vendedor\nÔ∏è Pdf listo para impresion`);
        }
        
        // Funci√≥n para mostrar datos en las secciones de queries
        function showData(elementId, data) {
            const element = document.getElementById(elementId);
            if (data && data.length > 0) {
                element.innerHTML = data.map(item => `
                    <div class="data-item">
                        <pre>${JSON.stringify(item, null, 2)}</pre>
                    </div>
                `).join('');
            } else {
                element.innerHTML = '<p>No hay datos disponibles</p>';
            }
        }
        
        // Formulario para crear gu√≠a
        document.getElementById('crearGuiaForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {
                remitente: {
                    nombres: formData.get('remitenteNombres'),
                    apellidos: formData.get('remitenteApellidos'),
                    telefono: formData.get('remitenteTelefono'),
                    direccion: {
                        calle: formData.get('remitenteCalle'),
                        numero: formData.get('remitenteNumero'),
                        numeroInterior: formData.get('remitenteNumeroInterior') || undefined,
                        ciudad: formData.get('remitenteCiudad'),
                        pais: formData.get('remitentePais'),
                        codigoPostal: formData.get('remitenteCodigoPostal'),
                        estado: formData.get('remitenteEstado'),
                        municipioDelegacion: formData.get('remitenteMunicipio'),
                        asentamiento: formData.get('remitenteAsentamiento') || undefined,
                        referencia: formData.get('remitenteReferencia') || undefined
                    }
                },
                destinatario: {
                    nombres: formData.get('destinatarioNombres'),
                    apellidos: formData.get('destinatarioApellidos'),
                    telefono: formData.get('destinatarioTelefono'),
                    direccion: {
                        calle: formData.get('destinatarioCalle'),
                        numero: formData.get('destinatarioNumero'),
                        numeroInterior: formData.get('destinatarioNumeroInterior') || undefined,
                        ciudad: formData.get('destinatarioCiudad'),
                        pais: formData.get('destinatarioPais'),
                        codigoPostal: formData.get('destinatarioCodigoPostal'),
                        estado: formData.get('destinatarioEstado'),
                        municipioDelegacion: formData.get('destinatarioMunicipio'),
                        asentamiento: formData.get('destinatarioAsentamiento') || undefined,
                        referencia: formData.get('destinatarioReferencia') || undefined
                    }
                },
                dimensiones: {
                    alto_cm: parseFloat(formData.get('alto')),
                    ancho_cm: parseFloat(formData.get('ancho')),
                    largo_cm: parseFloat(formData.get('largo'))
                },
                peso: parseFloat(formData.get('peso')),
                valorDeclarado: parseFloat(formData.get('valorDeclarado'))
            };
            
            // Mostrar indicador de carga
            const responseElement = document.getElementById('crearGuiaResponse');
            responseElement.className = 'response';
            responseElement.textContent = '‚è≥ Generando PDF... Por favor espere...';
            
            // Crear nombre del archivo
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const filename = `guia-${timestamp}.pdf`;
            
            // Descargar PDF
            const result = await downloadPDF(`${BASE_URL}/nuevaGuia`, data, filename);
            
            if (result.success) {
                // Simular n√∫mero de rastreo (en realidad se genera en el backend)
                const numeroRastreo = `GU${Date.now().toString().slice(-8)}MX`;
                
                // Mostrar notificaci√≥n de √©xito
                showPDFNotification(numeroRastreo);
                
                // Actualizar interfaz
                responseElement.className = 'response success';
                responseElement.textContent = `‚úÖ ¬°Gu√≠a creada exitosamente!\nüìÑ PDF descargado: ${filename}\nüî¢ N√∫mero de rastreo: ${numeroRastreo}\nüìß Notificaci√≥n enviada al vendedor`;
                
                // Limpiar formulario
                e.target.reset();
                
                // Actualizar la lista de gu√≠as
                setTimeout(updateQueries, 1000);
                
            } else {
                // Mostrar error
                responseElement.className = 'response error';
                responseElement.textContent = `‚ùå Error al crear la gu√≠a: ${result.error}`;
            }
        });
        
        // Formulario para registrar movimiento
        document.getElementById('registrarMovimientoForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {
                numeroGuia: formData.get('numeroGuia'),
                idSucursal: formData.get('idSucursal'),
                idRuta: formData.get('idRuta'),
                estado: formData.get('estado'),
                localizacion: formData.get('localizacion')
            };
            
            const response = await makeRequest(`${BASE_URL}/nuevoMovimiento`, 'POST', data);
            showResponse('registrarMovimientoResponse', response);
            
            if (response.success) {
                e.target.reset();
            }
        });
        
        // Formulario para crear incidencia
        document.getElementById('crearIncidenciaForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {
                numeroRastreo: formData.get('numeroRastreo'),
                tipoIncidencia: formData.get('tipoIncidencia'),
                descripcion: formData.get('descripcion'),
                idResponsable: formData.get('idResponsable')
            };
            
            const response = await makeRequest(`${BASE_URL}/nuevaIncidencia`, 'POST', data);
            showResponse('crearIncidenciaResponse', response);
            
            if (response.success) {
                e.target.reset();
            }
        });
        
        // Funci√≥n para buscar gu√≠a por n√∫mero
        async function buscarGuia() {
            const numero = document.getElementById('buscarNumero').value;
            if (!numero) {
                alert('Por favor ingrese un n√∫mero de rastreo');
                return;
            }
            
            const response = await makeRequest(`${BASE_URL}/buscar/${numero}`);
            const element = document.getElementById('buscarGuiaResult');
            
            if (response.success) {
                element.innerHTML = `
                    <div class="data-item">
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } else {
                element.innerHTML = `<p style="color: red;">Error: ${response.error || 'Gu√≠a no encontrada'}</p>`;
            }
        }
        
        // Funci√≥n para actualizar datos autom√°ticamente
        async function updateQueries() {
            // Obtener todas las gu√≠as
            const guiasResponse = await makeRequest(`${BASE_URL}/todas`);
            if (guiasResponse.success) {
                showData('todasGuias', guiasResponse.data.data);
            }
            
            // Obtener todas las incidencias
            const incidenciasResponse = await makeRequest(`${BASE_URL}/incidencias`);
            if (incidenciasResponse.success) {
                showData('todasIncidencias', incidenciasResponse.data.data);
            }
            
            // Obtener todos los contactos
            const contactosResponse = await makeRequest(`${BASE_URL}/contactos`);
            if (contactosResponse.success) {
                showData('todosContactos', contactosResponse.data.data);
            }
        }
        
        // Inicializar datos y configurar actualizaci√≥n autom√°tica
        updateQueries();
        setInterval(updateQueries, 3000); // Actualizar cada 3 segundos
        
        // Prellenar algunos campos con datos de ejemplo
        document.addEventListener('DOMContentLoaded', () => {
            // Datos de ejemplo para el remitente
            document.getElementById('remitenteNombres').value = 'Juan Carlos';
            document.getElementById('remitenteApellidos').value = 'Garc√≠a L√≥pez';
            document.getElementById('remitenteTelefono').value = '+525512345678';
            document.getElementById('remitenteCalle').value = 'Av. Reforma';
            document.getElementById('remitenteNumero').value = '456';
            document.getElementById('remitenteNumeroInterior').value = 'Depto 3B';
            document.getElementById('remitenteCiudad').value = 'Ciudad de M√©xico';
            document.getElementById('remitentePais').value = 'M√©xico';
            document.getElementById('remitenteCodigoPostal').value = '06600';
            document.getElementById('remitenteEstado').value = 'CDMX';
            document.getElementById('remitenteMunicipio').value = 'Cuauht√©moc';
            document.getElementById('remitenteAsentamiento').value = 'Ju√°rez';
            document.getElementById('remitenteReferencia').value = 'Entre Niza y Florencia, edificio azul';
            
            // Datos de ejemplo para el destinatario
            document.getElementById('destinatarioNombres').value = 'Mar√≠a Elena';
            document.getElementById('destinatarioApellidos').value = 'Rodr√≠guez Mart√≠nez';
            document.getElementById('destinatarioTelefono').value = '+523398765432';
            document.getElementById('destinatarioCalle').value = 'Calle Independencia';
            document.getElementById('destinatarioNumero').value = '789';
            document.getElementById('destinatarioCiudad').value = 'Guadalajara';
            document.getElementById('destinatarioPais').value = 'M√©xico';
            document.getElementById('destinatarioCodigoPostal').value = '44100';
            document.getElementById('destinatarioEstado').value = 'Jalisco';
            document.getElementById('destinatarioMunicipio').value = 'Guadalajara';
            document.getElementById('destinatarioAsentamiento').value = 'Centro Hist√≥rico';
            document.getElementById('destinatarioReferencia').value = 'Frente a la Catedral';
            
            // Datos de ejemplo para dimensiones
            document.getElementById('alto').value = '25';
            document.getElementById('ancho').value = '30';
            document.getElementById('largo').value = '40';
            document.getElementById('peso').value = '2.5';
            document.getElementById('valorDeclarado').value = '1500.00';
            
            // Datos de ejemplo para movimiento
            document.getElementById('idSucursal').value = 'SUC002MTY';
            document.getElementById('idRuta').value = 'RUT002CDMX';
            document.getElementById('localizacion').value = 'Sucursal Monterrey Centro, Nuevo Le√≥n, M√©xico';
            
            // Datos de ejemplo para incidencia
            document.getElementById('descripcion').value = 'El paquete se extravi√≥ en el camino';
            document.getElementById('idResponsable').value = '1234567890';
        });
    </script>
</body>
</html>
